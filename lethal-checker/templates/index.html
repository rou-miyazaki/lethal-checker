<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>リーサルチェッカー</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header>
        <h1>リーサルチェッカー</h1>
    </header>

    <main>
        <section class="upload-section">
            <h2>画像アップロード＆条件設定</h2>
            <form method="POST" enctype="multipart/form-data">
                <div class="form-block">
                    <label>スクリーンショットを選択</label>
                    <input type="file" name="image" accept="image/*"><br><br>
                </div>

                <div class="form-block">
                    <label>サイド選択</label>
                    <label><input type="radio" name="side" value="1P" checked> 1P側</label>
                    <label><input type="radio" name="side" value="2P"> 2P側</label>
                </div>

                <div class="form-block">
                    <label>操作タイプ:</label>
                    <select name="type">
                        <option value="2">モダン</option>
                        <option value="1">クラシック</option>
                    </select>
                </div>

                <div class="form-block">
                    <label>画面位置:</label>
                    <label><input type="radio" name="position" value="1" checked>中央</label>
                    <label><input type="radio" name="position" value="2">画面端</label>
                </div>

                <div class="form-block">
                    <label>SAゲージ:</label>
                    <select name="sa">
                        <option value="all">すべて</option>
                        <option value="0">0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="CA">CA</option>
                    </select>
                </div>

                <div class="form-block">
                    <label>始動技:</label>
                    <select name="starter">
                        <option value="all">すべて</option>
                        <option value="立ち小P">立ち小P</option>
                        <option value="立ち中P">立ち中P</option>
                        <option value="立ち大P">立ち大P</option>
                        <option value="立ち大K">立ち大K</option>
                        <option value="下小P">下小P</option>
                        <option value="下小K">下小K</option>
                        <option value="下中P">下中P</option>
                        <option value="下中K">下中K</option>
                        <option value="下大P">下大P</option>
                        <option value="前中P">前中P</option>
                        <option value="前大P">前大P</option>
                        <option value="引き大P">引き大P</option>
                    </select>
                </div>

                <div class="form-block">
                    <label>ヒット状況:</label>
                    <select name="pref">
                        <option value="all">すべて</option>
                        <option value="normal">ノーマルヒット</option>
                        <option value="counter">カウンターヒット</option>
                        <option value="punish">パニッシュカウンターヒット</option>
                    </select>
                </div>

                <div class="form-block button-group">
                    <button type="submit" class="analyze-btn">解析</button>
            </form>  <!-- ←ここでformが閉じるので注意 -->

            <form action="/reset" method="post" style="display: inline;">
                    <button type="submit" class="reset-btn">リセット</button>
            </form>
                </div>
        </section>

        {% if result %}
            <section class="result-section">
                <h2>アップロード画像:</h2>
                <img src="{{ image_url }}" alt="アップロード画像" class="uploaded-image">

            </section>
        {% endif %}
        {% if combos %}
            <section class="result-section">
                <h2>解析結果</h2>
                <p>{{ result }}</p>
            <table>
                <tr>
                    <th>コンボ</th>
                    <th>ダメージ</th>
                    <th>ドライブ</th>
                    <th>SA</th>
                    <th>状況</th>
                    <th>始動技</th>
                </tr>
                {% for combo in combos %}
                <tr>
                    <td>{{ combo.name }}</td>
                    <td>{{ combo.damage }}</td>
                    <td>{{ combo.drive }}</td>
                    <td>{{ combo.sa }}</td>
                    <td>{{ combo.situstion }}</td>
                    <td>{{ combo.starter }}</td>
                </tr>
                {% endfor %}
            </table>

            <!-- ページネーション -->
            <div class="pagination">
                {% for p in range(1, (total // per_page) + 2) %}
                    {% if p == page %}
                        <strong>{{ p }}</strong>
                    {% else %}
                        <a href="{{ url_for('index', page=p) }}">{{ p }}</a>
                    {% endif %}
                {% endfor %}
            </div>
        </section>
        {% endif %}
    </main>

    <footer>
        <p> 2025 倒し切り支援ツール</p>
    </footer>
</body>
</html>
